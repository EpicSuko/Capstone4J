allprojects {
    repositories {
        mavenCentral()
    }
}

subprojects {
    plugins.withType(JavaPlugin) {
        java {
            toolchain {
                languageVersion = JavaLanguageVersion.of(24)
            }
        }

        // Enable Java preview features for all subprojects
        tasks.withType(JavaCompile).configureEach {
            options.compilerArgs += '--enable-preview'
        }
        
        tasks.withType(Test).configureEach {
            jvmArgs += '--enable-preview'
            jvmArgs += '--enable-native-access=ALL-UNNAMED'
        }
        
        tasks.withType(JavaExec).configureEach {
            jvmArgs += '--enable-preview'
            jvmArgs += '--enable-native-access=ALL-UNNAMED'
        }
    }
}